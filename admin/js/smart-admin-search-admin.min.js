!function(e){"use strict";e.fn.sasSelect2=e.fn.select2,"undefined"!=typeof currentSelect2&&null!==currentSelect2&&(e.fn.select2=currentSelect2),e((function(){let s=e(document),t=(e("body"),e(".sas-search-modal")),n=e(".sas-search-modal__close"),l=e(".sas-search-modal__select"),a=e("#wp-admin-bar-sas_icon");a.on("mousedown",(function(){u()})),a.on("click",(function(e){e.preventDefault()}));let r=sas_values.options.search_keys_shortcut.sort().map(Number),c=[];function i(s){if(s.loading)return s.text;let t="";void 0!==s.preview&&null!==s.preview&&""!==s.preview&&(t=`\n\t\t\t\t\t<div class="sas-search-result__preview">${s.preview}</div>\n\t\t\t\t`);let n="<hr>";1==sas_values.options.show_results_url&&(n=s.link_url),""!==s.link_url&&null!==s.link_url||(n=sas_values.strings.no_permissions);let l=`\n\t\t\t\t<div class="sas-search-result__link-url">${n}</div>\n\t\t\t`;return e(`\n\t\t\t\t<div class="sas-search-result">\n\t\t\t\t\t<div class="sas-search-result__icon wp-menu-image dashicons-before ${s.icon_class}" style="${s.style}"></div>\n\t\t\t\t\t<div class="sas-search-result__info">\n\t\t\t\t\t\t<div class="sas-search-result__name">${s.text}</div>\n\t\t\t\t\t\t<div class="sas-search-result__description">${s.description}</div>\n\t\t\t\t\t\t${l}\n\t\t\t\t\t</div>\n\t\t\t\t\t${t}\n\t\t\t\t</div>\n\t\t\t\t`)}function o(e){return""===e.id?sas_values.strings.search_select_placeholder:e.text}function u(){t.addClass("sas-search-modal--opened"),l.sasSelect2({dropdownParent:t,width:"100%",placeholder:sas_values.strings.search_select_placeholder,minimumInputLength:3,allowClear:!0,templateResult:i,templateSelection:o,ajax:{method:"GET",url:sas_values.ajax.search_url,delay:400,beforeSend:function(e){e.setRequestHeader("X-WP-NONCE",sas_values.ajax.nonce)},data:function(e){return{query:e.term}},processResults:function(e){return{results:e}}}}),setTimeout((function(){l.sasSelect2("open")}),300)}function d(){l.hasClass("select2-hidden-accessible")&&(t.removeClass("sas-search-modal--opened"),l.sasSelect2("destroy"),l.empty())}s.on("keydown",(function(s){e(s.srcElement).hasClass("sas-skip-global-keypress")||(!1===c.includes(s.which)&&c.push(s.which),JSON.stringify(c.sort())===JSON.stringify(r)?u():c.includes(27)&&d())})),s.on("keyup",(function(s){e(s.srcElement).hasClass("sas-skip-global-keypress")||(c=[])})),t.on("click",(function(e){e.target===this&&d()})),n.on("click",(function(e){e.target===this&&d()})),l.on("select2:select",(function(e){let s=e.params.data;null!==s.link_url&&""!==s.link_url&&(window.location.href=s.link_url)})),l.on("select2:open",(function(){document.querySelector(".sas-search-modal--opened .select2-search__field").focus()}))}))}(jQuery);